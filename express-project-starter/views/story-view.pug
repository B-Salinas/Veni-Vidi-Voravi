extends layout.pug

include utils.pug

append head
  link(rel="stylesheet" href="/stylesheets/story-view.css")
  script(type="text/javascript" src="/javascripts/display-comments.js")
  script(type="text/javascript" src="/javascripts/claps.js")

block content
  include story-navbar.pug
  .story__container
    .story__title= story.title
    .story__author By #{user.firstName} #{user.lastName}
    .story__image(style=`background-image: url(${story.imageSrc})`)
    .story__content
        p= story.content
    .story__claps-comments
      if userClap 
        img(id="clap-button" class=`${story.id} has-been-clapped` src="../images/clap.png")
      else
        img(id="clap-button" class=`${story.id}` src="../images/comment.png")
        //- TODO: style the clap when it's CLAPPED
      span(id="clap-count")=clapCount
      img(id="comment-button" src="../images/comment.png")
      span=comments.length
    +validationErrorSummary(errors)
    .form.hidden
      form(action=`/stories/${story.id}/comments` method='post')
        input(type='hidden' name='_csrf' value=csrfToken)
        .form__inputs
            .form__comment-div
              input(type="text" name="comment" placeholder="Your comment")
            .form__button
              button(type="submit") Post
    .comments__container.hidden
      each comment in comments
        .comments__info
          .comments__pic
            img(class="profile-pic" src=`${user.profilePic}`)
          .comments__name
            p #{user.firstName} #{user.lastName}
          .comments__content
            p=comment.content
        br
  .footer
    .footer__links
      a(href="https://github.com/rsdimatulac/Veni-Vidi-Voravi")
        i(class="fab fa-github" aria-hidden="true")
